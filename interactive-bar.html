<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Exercise Portfolio</title>
  <link href="css/style.css" rel="stylesheet" />
</head>

<body>

<header>
  <!-- ADD YOUR NAME -->
  <h1>Yutong Han: Exercise Portfolio</h1>
</header>

<div id="content">

  <nav>
    <ul>
      <li><a href="index.html">Return to Main Page</a></li>
    </ul>
  </nav>

  <main>

    <h2><!-- VISUALIZATION TITLE --></h2>

    <p><!-- INFORMATION ABOUT YOUR VISUALIZATION: What is this about? --></p>
    <!-- ADD YOUR VISUALIZATION HERE -->

  </main>

  <div id="option">
    <input name="updateButton" type="button" d-type="1" value="Change" onclick="updateData(this)" />
  </div>
</div>

<script src="js/d3.min.js"></script>
<script src="js/lodash.min.js"></script>
<script src="js/pi.js"></script>
<script src="js/jquery-1.10.2.min.js"></script>
<script>
    // add your script here
    // OR
    // add a link to a stand-alone script in the js folder

    var svg = d3.select("body").append("svg");
    var margin = {
        top: 60,
        right: 60,
        left: 60,
        bottom: 60
    };
    var w = window.innerWidth;
    var h = window.innerHeight;
    svg.attr("width", w - margin.right).attr("height", h);
    d3.csv("./data/spring-training.csv").then(function(data) {
        data.forEach(function(d){
            d.wins = +d.wins;
            d.pct = +d.pct;
        });
        //球队，ABBR，联赛，赢，输，PCT
        var league = _.groupBy(data, "league");
        var grapefruit = league["G"];
        var cactus = league["C"];
        var xScale = d3.scaleLinear()
        .domain(d3.extent(grapefruit, function(d) {
            return d.wins;
        }))
        .range([0, (w - margin.left - margin.right)]);
        var yScale = d3.scaleLinear()
        .domain(d3.extent(grapefruit, function(d) {
            return d.losses;
        }))
        .range([(h - margin.top - margin.bottom), 0]);
        var line = d3.line()
            .x(function(d) {
                return xScale(d.wins);
            })
            .y(function(d) {
                return yScale(d.losses);
            })
        svg.append("g")
            .attr("transform", "translate("+ margin.left +", " + margin.top +")")
            .append("path")
            .datum(grapefruit)
            .attr("class", "data-line3")
            .attr("d", line)
            .on("click", function(d) {
                d3.select(this).attr("stroke","red");
            });
        var xAxis = d3.axisBottom()
            .scale(xScale)
            .ticks(20);
        var yAxis = d3.axisLeft()
            .scale(yScale)
            .ticks(10);
        svg.append("g")
            .attr("transform", "translate(" + margin.left + ", " + (h - margin.bottom) + ")")
            .attr("class", "xaxis")
            .call(xAxis);
        svg.append("g")
            .attr("transform", "translate(" + margin.left + ", " + margin.top + ")")
            .attr("class", "yaxis")
            .call(yAxis);
        // var maxRate = data.filter(function(d) {
        //     var max = d3.max(data, function(d) {
        //         return d.close;
        //     })
        //     if(d.close == max) {
        //         return d.close;
        //     }
        // });

        // svg.selectAll("circle")
        //     .data(maxRate)
        //     .enter()
        //     .append("circle")
        //     .attr("transform", "translate(" + margin.left +", "+ margin.top +")")
        //     .attr("cx", function(d) {
        //         return xScale(d.team)
        //     })
        //     .attr("cy", function(d) {
        //         return yScale(d.team)
        //     })
        //     .attr("r", 2);

        // var maxRateX = xScale(maxRate[0].team);
        // var maxRateY = yScale(maxRate[0].team);

        // svg.append("line")
        //     .attr("class", "note-line")
        //     .attr("transform", "translate(" + margin.left +", "+ margin.top +")")
        //     .attr("x1", (maxRateX +3))
        //     .attr("x2", (maxRateX +13))
        //     .attr("y1", (maxRateY -3))
        //     .attr("y2", (maxRateY -13));

        // svg.append("text")
        //     .text("Highest Close Price, " + maxRate[0].close + "dollar")
        //     .attr("x", (maxRateX + 14))
        //     .attr("y", (maxRateY - 14))
        //     .attr("transform", "translate(" + margin.left +", " + margin.top +")");


    });


    function updateData(_this) {
        var type = $(_this).attr('d-type');
        if(type == 1){
            d3.select('svg').remove();
            var svg = d3.select("body").append("svg");
            var margin = {
                top: 60,
                right: 60,
                left: 60,
                bottom: 60
            };
            var w = window.innerWidth;
            var h = window.innerHeight;
            svg.attr("width", w - margin.right).attr("height", h);
            d3.csv("./data/spring-training.csv").then(function(data) {
                data.forEach(function(d){
                    d.wins = +d.wins;
                    d.pct = +d.pct;
                });
                //球队，ABBR，联赛，赢，输，PCT
                var league = _.groupBy(data, "league");
                var grapefruit = league["G"];
                var cactus = league["C"];
                var xScale = d3.scaleLinear()
                    .domain(d3.extent(cactus, function(d) {
                        console.log(d);
                        return d.wins;
                    }))
                    .range([0, (w - margin.left - margin.right)]);
                var yScale = d3.scaleLinear()
                    .domain(d3.extent(cactus, function(d) {
                        return d.losses;
                    }))
                    .range([(h - margin.top - margin.bottom), 0]);

                var line = d3.line()
                    .x(function(d) {
                        return xScale(d.wins);
                    })
                    .y(function(d) {
                        return yScale(d.losses);
                    });

                console.log(line);
                svg.append("g")
                    .attr("transform", "translate("+ margin.left +", " + margin.top +")")
                    .append("path")
                    .datum(cactus)
                    .attr("class", "data-line3")
                    .attr("d", line)
                    .on("click", function(d) {
                        d3.select(this).attr("stroke","red");
                    });

                var xAxis = d3.axisBottom()
                    .scale(xScale)
                    .ticks(20);

                var yAxis = d3.axisLeft()
                    .scale(yScale)
                    .ticks(10);

                svg.append("g")
                    .attr("transform", "translate(" + margin.left + ", " + (h - margin.bottom) + ")")
                    .attr("class", "xaxis")
                    .call(xAxis);

                svg.append("g")
                    .attr("transform", "translate(" + margin.left + ", " + margin.top + ")")
                    .attr("class", "yaxis")
                    .call(yAxis);
            });
        }else{
            $(_this).attr('d-type','2');
            d3.select('svg').remove();
            var svg = d3.select("body").append("svg");
            var margin = {
                top: 60,
                right: 60,
                left: 60,
                bottom: 60
            };
            var w = window.innerWidth;
            var h = window.innerHeight;
            svg.attr("width", w - margin.right).attr("height", h);
            d3.csv("./data/spring-training.csv").then(function(data) {
                data.forEach(function(d){
                    d.wins = +d.wins;
                    d.pct = +d.pct;
                });
                //球队，ABBR，联赛，赢，输，PCT
                var league = _.groupBy(data, "league");
                var grapefruit = league["G"];
                var cactus = league["C"];
                var xScale = d3.scaleLinear()
                    .domain(d3.extent(grapefruit, function(d) {
                        console.log(d);
                        return d.wins;
                    }))
                    .range([0, (w - margin.left - margin.right)]);
                var yScale = d3.scaleLinear()
                    .domain(d3.extent(grapefruit, function(d) {
                        return d.losses;
                    }))
                    .range([(h - margin.top - margin.bottom), 0]);

                var line = d3.line()
                    .x(function(d) {
                        return xScale(d.wins);
                    })
                    .y(function(d) {
                        return yScale(d.losses);
                    });

                console.log(line);
                svg.append("g")
                    .attr("transform", "translate("+ margin.left +", " + margin.top +")")
                    .append("path")
                    .datum(grapefruit)
                    .attr("class", "data-line3")
                    .attr("d", line)
                    .on("click", function(d) {
                        d3.select(this).attr("stroke","red");
                    });

                var xAxis = d3.axisBottom()
                    .scale(xScale)
                    .ticks(20);

                var yAxis = d3.axisLeft()
                    .scale(yScale)
                    .ticks(10);

                svg.append("g")
                    .attr("transform", "translate(" + margin.left + ", " + (h - margin.bottom) + ")")
                    .attr("class", "xaxis")
                    .call(xAxis);

                svg.append("g")
                    .attr("transform", "translate(" + margin.left + ", " + margin.top + ")")
                    .attr("class", "yaxis")
                    .call(yAxis);
            });
        }
    }



















</script>
</body>
</html>
